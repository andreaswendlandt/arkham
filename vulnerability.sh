#!/bin/bash


#ensure this script started with root privileges
if [ $(id -u) -ne 0 ]; then
    echo "ERROR: This script must be run as root"
    exit 1
fi

#Required Packages: nmap, flock
required_packages=(nmap flock foo)
max=${#required_packages[*]}
echo $max
i=0
while (( i < max ))
do
	   echo "Feld $i: ${required_packages[$i]}"
	   i=$(expr $i + 1)
      done

# ensure we are the only running instance
##todo logging for this and logging in general
pidfile="/var/run/$(basename $0)"
exec 200>$pidfile
flock -n 200 ||  exit 1
pid=$$
echo $pid 1>&200


#network
open_ports=$(nmap -v localhost | egrep '^[[:digit:]]' | awk '$2 ~ open {print $1}')
echo -e "these ports are open: \n$open_ports"

